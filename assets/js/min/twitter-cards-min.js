function convertToLinks(e){var t,a,r,n;return a=/(\b(https?):\/\/[-A-Z0-9+&amp;@#\/%?=~_|!:,.;]*[-A-Z0-9+&amp;@#\/%=~_|])/gi,t=e.replace(a,'<a class="colored-link-1" title="$1" href="$1" target="_blank">$1</a>'),r=/(^|[^\/])(www\.[\S]+(\b|$))/gim,t=t.replace(r,'$1<a class="colored-link-1" href="http://$2" target="_blank">$2</a>'),t=t.replace(/#(\S*)/g,'<a href="http://twitter.com/#!/search/$1"  target="_blank">#$1</a>'),t=t.replace(/@([a-z\d_]+)/gi,'<a href="http://twitter.com/$1">@$1</a>')}function parseTwitterDate(e){var t=new Date(Date.parse(e)),a=new Date;K.ie&&(t=Date.parse(e.replace(/( \+)/," UTC$1")));var r=Math.floor((a-t)/1e3);if(1>=r)return"just now";if(20>r)return r+" seconds ago";if(40>r)return"half a minute ago";if(60>r)return"less than a minute ago";if(90>=r)return"one minute ago";if(3540>=r)return Math.round(r/60)+" minutes ago";if(5400>=r)return"1 hour ago";if(86400>=r)return Math.round(r/3600)+" hours ago";if(129600>=r)return"1 day ago";if(604800>r)return Math.round(r/86400)+" days ago";if(777600>=r)return"1 week ago";if(263e4>=r)return"over 1 week ago";var n=new Date(t);return"on "+(n.getMonth()+1)+"-"+n.getDate()+"-"+n.getFullYear()}var twitterHandle="jimcamut",pathToTwitterProxy="/twitter-proxy.php",tweetProxy="/twitter-proxy.php/?url="+encodeURIComponent("statuses/user_timeline.json?screen_name="+twitterHandle+"&count=100&include_rts=false&exclude_replies=true"),numOfTweets=5,localData=JSON.parse(localStorage.getItem("twitterData"))||!1,dataStream,K=function(){var e=navigator.userAgent;return{ie:e.match(/MSIE\s([^;]*)/)}}();jQuery.noConflict(),jQuery(document).ready(function($){function e(){console.log("Twitter data is from localStorage."),dataStream=localData.data,r(dataStream)}function t(e){for(var t=[],a=0;a<e.length;a++)tweets[a]={},tweets[a].tweet=convertToLinks(e[a].text),tweets[a].id=e[a].id,tweets[a].name=e[a].user.name,e[a].entities.media&&(tweets[a].img=e[a].entities.media[0].media_url,tweets[a].imgUrl=e[a].entities.media[0].expanded_url),tweets[a].url="https://twitter.com/"+twitterHandle+"/status/"+e[a].id_str,tweets[a].date=new Date(e[a].created_at),tweets[a].dateParsed=parseTwitterDate(e[a].created_at),t.push(tweets[a]);return t}function a(e){var t=$("<li data-id="+e.id+" class='new'><p class='tweet-head'><a href='https://twitter.com/"+e.name+"' target='_blank'>"+e.name+"</a> / "+e.dateParsed+"</p><p>"+e.tweet+"</p></li>");if(e.img){var a=$("<a href='"+e.imgUrl+"' class='tweet-img' target='_blank'><img src='"+e.img+"'  /></a>");t.append(a)}return t}function r(e){$("#tweets .removeMe").hide(),$("#tweet-error").hide();var r=[],n=e.length,o=[],i=function(){var a=new jQuery.Deferred;return a.resolve(t(e)),a.promise()};$.when(i()).then(function(e){var t;if(e&&(t=e),t)for(var r=0;numOfTweets>r;r++)if(t[r]){var n=a(t[r]);$("#tweetContainer").append(n)}else $("#tweet-error").show().html("Cannot display tweets at this time. Please try back later, or visit our Twitter page at <a href='https://twitter.com/Gooee' target='_blank'>https://twitter.com/Gooee</a>.");else $("#tweet-error").show().html("Cannot display tweets at this time. Please try back later, or visit our Twitter page at <a href='https://twitter.com/Gooee' target='_blank'>https://twitter.com/Gooee</a>.");var o=$("#tweetContainer li");$.each(o,function(e,t){setTimeout(function(){$(t).addClass("added")},100*(e+1))})})}function n(e){function r(){var e=$("#tweetContainer li").length,t=n.length,a=t-e;0>=a&&$("#more-tweets").hide()}var n=t(dataStream),o=[];$("#tweetContainer li").each(function(e,t){var a=$(t).data("id");o[e]=a}).promise().done(function(t){for(var i=o.length+e,s=o.length;i>s;s++)if(n[s]){var l=a(n[s]);$("#tweetContainer").append(l)}else $("#tweet-error").show().html("Cannot display tweets at this time. Please try back later, or visit our Twitter page at <a href='https://twitter.com/Gooee' target='_blank'>https://twitter.com/Gooee</a>.");var c=$("#tweetContainer li.new");$.each(c,function(e,t){setTimeout(function(){$(t).addClass("added").removeClass("new")},100*(e+1))}),r()})}function o(){$.ajax({type:"GET",url:tweetProxy,success:function(e){dataStream=e,r(e),console.log("Twitter data is fresh from the Twitter API.");var t={};t.updated=new Date,t.data=e,localStorage.setItem("twitterData",JSON.stringify(t))},error:function(e){$("#tweet-error").show().html("Cannot display tweets at this time. Please try back later, or visit our Twitter page at <a href='https://twitter.com/Gooee' target='_blank'>https://twitter.com/Gooee</a>."),console.log("getTweets error"),console.log(e)}})}function i(){$.ajax({type:"GET",url:tweetProxy,success:function(e){var t=e,a=[],r=function(){function e(){return $("#tweetContainer li").each(function(e,t){var r=$(t).data("id");a.push(r)}),a}var t=new jQuery.Deferred;return t.resolve(e()),t.promise()};$.when(r()).then(function(e){for(var a=e,r=0;r<a.length;r++){for(var n=0;n<t.length;n++)t[n].id===a[r]&&t.splice(n,1);if(r===a.length-1){t.reverse();for(var o=0;o<t.length;o++){var i=convertToLinks(t[o].text);$("#tweetContainer").prepend("<li class='new' data-id="+t[o].id+">"+i+"</li>")}setTimeout(function(){$("#tweetContainer li.new").addClass("added");var e=6;if($("#tweetContainer li").length>=e)for(var t=$("#tweetContainer li").length,a=t-e,r=t-a;t>r;r++)$("#tweetContainer li:eq("+r+")").addClass("hidden")},100)}}})},error:function(e){console.log("newest Tweets error"),console.log(e)}})}if(0===$("#tweetContainer li").length){var s=new Date,l=6e4,c=10*l,w=function(){return localData?Date.parse(localData.updated):c+1};s-w()>=c?o():e()}$("#more-tweets").click(function(e){e.preventDefault(),n(6)})});